layui.define("jquery",(function(e){"use strict";var i=layui.jquery,o={config:{},index:layui.colorpicker?layui.colorpicker.index+1e4:0,set:function(e){var o=this;return o.config=i.extend({},o.config,e),o},on:function(e,i){return layui.onevent.call(this,"colorpicker",e,i)}},r=function(){return{config:this.config}},t="layui-colorpicker",n=".layui-colorpicker-main",l="layui-icon-down",c="layui-icon-close",a="layui-colorpicker-trigger-span",s="layui-colorpicker-trigger-i",f="layui-colorpicker-side-slider",d="layui-colorpicker-basis",u="layui-colorpicker-alpha-bgcolor",p="layui-colorpicker-alpha-slider",g="layui-colorpicker-basis-cursor",v="layui-colorpicker-main-input",h=function(e){var i={h:0,s:0,b:0},o=Math.min(e.r,e.g,e.b),r=Math.max(e.r,e.g,e.b),t=r-o;return i.b=r,i.s=0!=r?255*t/r:0,0!=i.s?e.r==r?i.h=(e.g-e.b)/t:e.g==r?i.h=2+(e.b-e.r)/t:i.h=4+(e.r-e.g)/t:i.h=-1,r==o&&(i.h=0),i.h*=60,i.h<0&&(i.h+=360),i.s*=100/255,i.b*=100/255,i},m=function(e){var i={},o=e.h,r=255*e.s/100,t=255*e.b/100;if(0==r)i.r=i.g=i.b=t;else{var n=t,l=(255-r)*t/255,c=o%60*(n-l)/60;360==o&&(o=0),o<60?(i.r=n,i.b=l,i.g=l+c):o<120?(i.g=n,i.b=l,i.r=n-c):o<180?(i.g=n,i.r=l,i.b=l+c):o<240?(i.b=n,i.r=l,i.g=n-c):o<300?(i.b=n,i.g=l,i.r=l+c):o<360?(i.r=n,i.g=l,i.b=n-c):(i.r=0,i.g=0,i.b=0)}return{r:Math.round(i.r),g:Math.round(i.g),b:Math.round(i.b)}},b=function(e){var o=m(e),r=[o.r.toString(16),o.g.toString(16),o.b.toString(16)];return i.each(r,(function(e,i){1==i.length&&(r[e]="0"+i)})),r.join("")},k=function(e){var i=e.match(/[0-9]{1,3}/g)||[];return{r:i[0],g:i[1],b:i[2]}},y=i(window),x=i(document),C=function(e){var r=this;r.index=++o.index,r.config=i.extend({},r.config,o.config,e),r.render()};C.prototype.config={color:"",size:null,alpha:!1,format:"hex",predefine:!1,colors:["#009688","#5FB878","#1E9FFF","#FF5722","#FFB800","#01AAED","#999","#c00","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585","rgb(0, 186, 189)","rgb(255, 120, 0)","rgb(250, 212, 0)","#393D49","rgba(0,0,0,.5)","rgba(255, 69, 0, 0.68)","rgba(144, 240, 144, 0.5)","rgba(31, 147, 255, 0.73)"]},C.prototype.render=function(){var e=this,o=e.config,r=i(['<div class="layui-unselect layui-colorpicker">',"<span "+("rgb"==o.format&&o.alpha?'class="layui-colorpicker-trigger-bgcolor"':"")+">",'<span class="layui-colorpicker-trigger-span" ','lay-type="'+("rgb"==o.format?o.alpha?"rgba":"torgb":"")+'" ','style="'+function(){var e="";return o.color?(e=o.color,(o.color.match(/[0-9]{1,3}/g)||[]).length>3&&(o.alpha&&"rgb"==o.format||(e="#"+b(h(k(o.color))))),"background: "+e):e}()+'">','<i class="layui-icon layui-colorpicker-trigger-i '+(o.color?l:c)+'"></i>',"</span>","</span>","</div>"].join("")),t=i(o.elem);o.size&&r.addClass("layui-colorpicker-"+o.size),t.addClass("layui-inline").html(e.elemColorBox=r),e.color=e.elemColorBox.find("."+a)[0].style.background,e.events()},C.prototype.renderPicker=function(){var e=this,o=e.config,r=e.elemColorBox[0],t=e.elemPicker=i(['<div id="layui-colorpicker'+e.index+'" data-index="'+e.index+'" class="layui-anim layui-anim-upbit layui-colorpicker-main">','<div class="layui-colorpicker-main-wrapper">','<div class="layui-colorpicker-basis">','<div class="layui-colorpicker-basis-white"></div>','<div class="layui-colorpicker-basis-black"></div>','<div class="layui-colorpicker-basis-cursor"></div>',"</div>",'<div class="layui-colorpicker-side">','<div class="layui-colorpicker-side-slider"></div>',"</div>","</div>",'<div class="layui-colorpicker-main-alpha '+(o.alpha?"layui-show":"")+'">','<div class="layui-colorpicker-alpha-bgcolor">','<div class="layui-colorpicker-alpha-slider"></div>',"</div>","</div>",function(){if(o.predefine){var e=['<div class="layui-colorpicker-main-pre">'];return layui.each(o.colors,(function(i,o){e.push(['<div class="layui-colorpicker-pre'+((o.match(/[0-9]{1,3}/g)||[]).length>3?" layui-colorpicker-pre-isalpha":"")+'">','<div style="background:'+o+'"></div>',"</div>"].join(""))})),e.push("</div>"),e.join("")}return""}(),'<div class="layui-colorpicker-main-input">','<div class="layui-inline">','<input type="text" class="layui-input">',"</div>",'<div class="layui-btn-container">','<button class="layui-btn layui-btn-primary layui-btn-sm" colorpicker-events="clear">清空</button>','<button class="layui-btn layui-btn-sm" colorpicker-events="confirm">确定</button>',"</div","</div>","</div>"].join(""));e.elemColorBox.find("."+a)[0],i(n)[0]&&i(n).data("index")==e.index?e.removePicker(C.thisElemInd):(e.removePicker(C.thisElemInd),i("body").append(t)),C.thisElemInd=e.index,C.thisColor=r.style.background,e.position(),e.pickerEvents()},C.prototype.removePicker=function(e){var o=this;return o.config,i("#layui-colorpicker"+(e||o.index)).remove(),o},C.prototype.position=function(){var e=this,i=e.config,o=e.bindElem||e.elemColorBox[0],r=e.elemPicker[0],t=o.getBoundingClientRect(),n=r.offsetWidth,l=r.offsetHeight,c=function(e){return e=e?"scrollLeft":"scrollTop",document.body[e]|document.documentElement[e]},a=function(e){return document.documentElement[e?"clientWidth":"clientHeight"]},s=t.left,f=t.bottom;f+=5,(s-=(n-o.offsetWidth)/2)+n+5>a("width")?s=a("width")-n-5:s<5&&(s=5),f+l+5>a()&&(f=t.top>l?t.top-l:a()-l,f-=10),i.position&&(r.style.position=i.position),r.style.left=s+("fixed"===i.position?0:c(1))+"px",r.style.top=f+("fixed"===i.position?0:c())+"px"},C.prototype.val=function(){var e=this,i=(e.config,e.elemColorBox.find("."+a)),o=e.elemPicker.find("."+v),r=i[0].style.backgroundColor;if(r){var t=h(k(r)),n=i.attr("lay-type");if(e.select(t.h,t.s,t.b),"torgb"===n&&o.find("input").val(r),"rgba"===n){var l=k(r);if(3==(r.match(/[0-9]{1,3}/g)||[]).length)o.find("input").val("rgba("+l.r+", "+l.g+", "+l.b+", 1)"),e.elemPicker.find("."+p).css("left",280);else{o.find("input").val(r);var c=280*r.slice(r.lastIndexOf(",")+1,r.length-1);e.elemPicker.find("."+p).css("left",c)}e.elemPicker.find("."+u)[0].style.background="linear-gradient(to right, rgba("+l.r+", "+l.g+", "+l.b+", 0), rgb("+l.r+", "+l.g+", "+l.b+"))"}}else e.select(0,100,100),o.find("input").val(""),e.elemPicker.find("."+u)[0].style.background="",e.elemPicker.find("."+p).css("left",280)},C.prototype.side=function(){var e=this,o=e.config,r=e.elemColorBox.find("."+a),t=r.attr("lay-type"),n=e.elemPicker.find(".layui-colorpicker-side"),b=e.elemPicker.find("."+f),x=e.elemPicker.find("."+d),C=e.elemPicker.find("."+g),P=e.elemPicker.find("."+u),B=e.elemPicker.find("."+p),w=b[0].offsetTop/180*360,D=100-(C[0].offsetTop+3)/180*100,E=(C[0].offsetLeft+3)/260*100,H=Math.round(B[0].offsetLeft/280*100)/100,W=e.elemColorBox.find("."+s),j=e.elemPicker.find(".layui-colorpicker-pre").children("div"),F=function(i,n,a,s){e.select(i,n,a);var f=m({h:i,s:n,b:a});if(W.addClass(l).removeClass(c),r[0].style.background="rgb("+f.r+", "+f.g+", "+f.b+")","torgb"===t&&e.elemPicker.find("."+v).find("input").val("rgb("+f.r+", "+f.g+", "+f.b+")"),"rgba"===t){var d;d=280*s,B.css("left",d),e.elemPicker.find("."+v).find("input").val("rgba("+f.r+", "+f.g+", "+f.b+", "+s+")"),r[0].style.background="rgba("+f.r+", "+f.g+", "+f.b+", "+s+")",P[0].style.background="linear-gradient(to right, rgba("+f.r+", "+f.g+", "+f.b+", 0), rgb("+f.r+", "+f.g+", "+f.b+"))"}o.change&&o.change(e.elemPicker.find("."+v).find("input").val())},L=i(['<div class="layui-auxiliar-moving" id="LAY-colorpicker-moving"></div'].join("")),M=function(e){i("#LAY-colorpicker-moving")[0]||i("body").append(L),L.on("mousemove",e),L.on("mouseup",(function(){L.remove()})).on("mouseleave",(function(){L.remove()}))};b.on("mousedown",(function(e){var i=this.offsetTop,o=e.clientY;M((function(e){var r=i+(e.clientY-o),t=n[0].offsetHeight;r<0&&(r=0),r>t&&(r=t);var l=r/180*360;w=l,F(l,E,D,H),e.preventDefault()})),e.preventDefault()})),n.on("click",(function(e){var o=e.clientY-i(this).offset().top;o<0&&(o=0),o>this.offsetHeight&&(o=this.offsetHeight);var r=o/180*360;w=r,F(r,E,D,H),e.preventDefault()})),C.on("mousedown",(function(e){var i=this.offsetTop,o=this.offsetLeft,r=e.clientY,t=e.clientX;layui.stope(e),M((function(e){var n=i+(e.clientY-r),l=o+(e.clientX-t),c=x[0].offsetHeight-3,a=x[0].offsetWidth-3;n<-3&&(n=-3),n>c&&(n=c),l<-3&&(l=-3),l>a&&(l=a);var s=(l+3)/260*100,f=100-(n+3)/180*100;D=f,E=s,F(w,s,f,H),e.preventDefault()})),e.preventDefault()})),x.on("mousedown",(function(e){var o=e.clientY-i(this).offset().top-3+y.scrollTop(),r=e.clientX-i(this).offset().left-3+y.scrollLeft();o<-3&&(o=-3),o>this.offsetHeight-3&&(o=this.offsetHeight-3),r<-3&&(r=-3),r>this.offsetWidth-3&&(r=this.offsetWidth-3);var t=(r+3)/260*100,n=100-(o+3)/180*100;D=n,E=t,F(w,t,n,H),e.preventDefault(),C.trigger(e,"mousedown")})),B.on("mousedown",(function(e){var i=this.offsetLeft,o=e.clientX;M((function(e){var r=i+(e.clientX-o),t=P[0].offsetWidth;r<0&&(r=0),r>t&&(r=t);var n=Math.round(r/280*100)/100;H=n,F(w,E,D,n),e.preventDefault()})),e.preventDefault()})),P.on("click",(function(e){var o=e.clientX-i(this).offset().left;o<0&&(o=0),o>this.offsetWidth&&(o=this.offsetWidth);var r=Math.round(o/280*100)/100;H=r,F(w,E,D,r),e.preventDefault()})),j.each((function(){i(this).on("click",(function(){i(this).parent(".layui-colorpicker-pre").addClass("selected").siblings().removeClass("selected");var e=this.style.backgroundColor,o=h(k(e)),r=e.slice(e.lastIndexOf(",")+1,e.length-1);w=o.h,E=o.s,D=o.b,3==(e.match(/[0-9]{1,3}/g)||[]).length&&(r=1),H=r,F(o.h,o.s,o.b,r)}))}))},C.prototype.select=function(e,i,o,r){var t=this,n=(t.config,b({h:e,s:100,b:100})),l=b({h:e,s:i,b:o}),c=e/360*180,a=180-o/100*180-3,s=i/100*260-3;t.elemPicker.find("."+f).css("top",c),t.elemPicker.find("."+d)[0].style.background="#"+n,t.elemPicker.find("."+g).css({top:a,left:s}),"change"!==r&&t.elemPicker.find("."+v).find("input").val("#"+l)},C.prototype.pickerEvents=function(){var e=this,o=e.config,r=e.elemColorBox.find("."+a),t=e.elemPicker.find("."+v+" input"),n={clear:function(i){r[0].style.background="",e.elemColorBox.find("."+s).removeClass(l).addClass(c),e.color="",o.done&&o.done(""),e.removePicker()},confirm:function(i,n){var a=t.val(),f=a,d={};if(a.indexOf(",")>-1){if(d=h(k(a)),e.select(d.h,d.s,d.b),r[0].style.background=f="#"+b(d),(a.match(/[0-9]{1,3}/g)||[]).length>3&&"rgba"===r.attr("lay-type")){var u=280*a.slice(a.lastIndexOf(",")+1,a.length-1);e.elemPicker.find("."+p).css("left",u),r[0].style.background=a,f=a}}else d=function(e){if(3==(e=e.indexOf("#")>-1?e.substring(1):e).length){var i=e.split("");e=i[0]+i[0]+i[1]+i[1]+i[2]+i[2]}return e=parseInt(e,16),h({r:e>>16,g:(65280&e)>>8,b:255&e})}(a),r[0].style.background=f="#"+b(d),e.elemColorBox.find("."+s).removeClass(c).addClass(l);return"change"===n?(e.select(d.h,d.s,d.b,n),void(o.change&&o.change(f))):(e.color=a,o.done&&o.done(a),void e.removePicker())}};e.elemPicker.on("click","*[colorpicker-events]",(function(){var e=i(this),o=e.attr("colorpicker-events");n[o]&&n[o].call(this,e)})),t.on("keyup",(function(e){var o=i(this);n.confirm.call(this,o,13===e.keyCode?null:"change")}))},C.prototype.events=function(){var e=this,o=e.config,r=e.elemColorBox.find("."+a);e.elemColorBox.on("click",(function(){e.renderPicker(),i(n)[0]&&(e.val(),e.side())})),o.elem[0]&&!e.elemColorBox[0].eventHandler&&(x.on("click",(function(o){if(!i(o.target).hasClass(t)&&!i(o.target).parents("."+t)[0]&&!i(o.target).hasClass(n.replace(/\./g,""))&&!i(o.target).parents(n)[0]&&e.elemPicker){if(e.color){var a=h(k(e.color));e.select(a.h,a.s,a.b)}else e.elemColorBox.find("."+s).removeClass(l).addClass(c);r[0].style.background=e.color||"",e.removePicker()}})),y.on("resize",(function(){return!(!e.elemPicker||!i(n)[0])&&void e.position()})),e.elemColorBox[0].eventHandler=!0)},o.render=function(e){var i=new C(e);return r.call(i)},e("colorpicker",o)}));