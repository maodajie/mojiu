/*!
 * @name:mojiu
 * @author:大橙子
 * @description:苹果CMS v10 多功能响应式模板
 * @website:http://maodajie.com
 * @qqcode:1570457334
 * @telegram:https://t.me/mubanqun
 * @version:2021.0223.1109
 */layui.define(["common"],(function(n){window.$=window.jQuery=layui.$;var i={define:"",array:[],global:{init:function(){layui.form.render(),i.multiple.render(),i.iconfont.render(),i.popup.init(),layui.util.fixbar(),layui.laydate.render({elem:".mo-date-time",type:"datetime"}),layui.form.on("select(unique)",(function(n){$(this).parents("td").prev().find("input").val(n.elem[n.elem.selectedIndex].dataset.url)})),layui.form.on("select(navtid)",(function(n){$(this).parents("td").prev().prev().find("input").val(n.elem[n.elem.selectedIndex].dataset.type),$(this).parents("td").next().find("input").val(n.elem[n.elem.selectedIndex].dataset.link)})),layui.form.on("select(navmid)",(function(n){$(this).parents("td").next().next().find("input").val(n.elem[n.elem.selectedIndex].dataset.name),$(this).parents("td").next().next().next().find("input").val(n.elem[n.elem.selectedIndex].dataset.link)})),layui.form.on("select(navico)",(function(n){$(this).parents("td").prev().find("input").next().find("span").find("i").attr("class","ts-font-btns mo-icon-font "+n.elem[n.elem.selectedIndex].dataset.icon),$(this).parents("td").prev().find("input").val(n.elem[n.elem.selectedIndex].dataset.icon),$(this).parents("td").next().find("input").val(n.elem[n.elem.selectedIndex].dataset.url);var i=$(this).parents("td").next().attr("lay-filter");if("artist"==n.value)var e='<select name="mojia[home]['+i+'][link]" lay-filter="choose"><option value="" data-check="art">添加数据</option></select>';else e='<input type="text" name="mojia[nav]['+i+'][link]" value="'+n.elem[n.elem.selectedIndex].dataset.url+'" class="layui-input" placeholder="请填写链接地址">';$(this).parents("td").next().html(e),layui.form.render(null,i)})),layui.form.on("submit(homeup)",(function(n){var i=$(this).parents("tr");0!=i.index()&&i.prev().before(i).fadeOut().fadeIn(),$(this).parents("tbody").find("tr").each((function(n,i){$(this).find("td").eq(0).find("input").eq(0).val(n+1)}))})),layui.form.on("submit(homedn)",(function(n){var i=$(this).parents("tr");i.index()!=$(this).parents("tbody").find("tr").length&&i.next().after(i).fadeOut().fadeIn(),$(this).parents("tbody").find("tr").each((function(n,i){$(this).find("td").eq(0).find("input").eq(0).val(n+1)}))})),layui.form.on("submit(submit)",(function(n){return layer.load(2),$.post(location.href,n.field,(function(n){layer.closeAll(),layer.msg(n.msg,{time:1e3},(function(){location.reload()}))})).error((function(n){layer.msg("请求失败："+n.status)}),"json"),!1})),layui.form.on("submit(reset)",(function(n){return layer.confirm("确定恢复默认设置吗",{title:"提示"},(function(){$.post(location.href,"type=reset",(function(n){layer.msg(n.msg,{time:500},(function(){location.reload()}))})).error((function(n){layer.msg("请求失败："+n.status)}),"json")})),!1})),layui.form.on("submit(colour)",(function(n){$(n.elem).css({color:"#ffffff","border-color":n.elem.dataset.back,"background-color":n.elem.dataset.back}).parent().siblings("td").find("button").removeAttr("style"),$('input[name="mojia[color][type][name]"]').val(n.elem.dataset.type);for(var i=n.elem.dataset.color.split(","),e=0;e<i.length;e++)$(".mo-look-btns").eq(e).parent().prev().find("input").val(i[e])})),$(".mo-look-btns").each((function(n,i){layui.colorpicker.render({elem:$(this),color:$(this).parent().prev().find("input").val(),predefine:!0,format:"rgb",alpha:!0,done:function(n){$(this).parent().prev().find("input").val(n)}})}))}},popup:{init:function(){i.popup.update(),i.popup.seokey(),i.popup.browse(),i.popup.choose(),$(document).on("click",".ts-drag-seos",(function(n){i.sorter.init(".ts-drag-sort")})),$(document).on("click",".mo-icon-shibai-line",(function(n){$(this).parent().parent().remove()})),$(document).on("click",".mo-icon-zengjia-line",(function(n){$(this).parents("ul").prev().prev().append(i.popup.text($(this).prev().attr("data-code"),"shibai",0,1))})),$(document).on("click",".layui-btn-primary",(function(n){var e=$(this).parent().prev().find("input").val();if(!e)return!1;$(this).parents("table").prev().append(i.popup.text(e,"shibai",0,1))})),layui.form.on("submit(lookup)",(function(n){var i=$(this).parents("td").prev().prev().find("input").val();layer.open({type:1,title:!1,shadeClose:!0,area:["300px","300px"],content:'<img width="100%" src="'+(-1!=i.indexOf("//")?i:magic.path+i)+'"/>'})})),layui.upload.render({elem:".layui-upload",url:magic.admin+"/admin/upload/upload.html?flag=site",before:function(n){layer.msg("文件上传中...",{time:3e6})},done:function(n,i,e){if(layer.closeAll(),0==n.code)return layer.msg(n.msg),!1;$(this.item).parent().parent().find(".layui-upfile").val(n.data.file),layer.msg(n.msg,{time:1e3})}})},custom:'<table class="layui-table"><tbody><tr><td width="70">自定义内容</td><td><input type="text" class="layui-input" placeholder="自定义内容"></td><td width="90"><a class="layui-btn layui-btn-primary">添加内容</a></td></tr><tbody></table>',text:function(n,i,e,o){var t='<li class="dc-iblock dc-ma-5'+(o?" ts-drag-sort":"")+'">';return t+='<a class="layui-btn layui-btn-sm dc-pa-0"><span class="dc-row dc-pl-10 ts-drag-text'+(o?" ts-drag-move":"")+'" data-code="'+e+'">'+n+'</span><i class="dc-pn-10 mo-icon-font mo-icon-'+i+'-line" style="vertical-align:top"></i></a>',t+="</li>"},browse:function(){layui.form.on("submit(browse)",(function(n){var e=$(this);layer.open({type:1,btn:"确认修改",area:["640px","500px"],content:'<ul class="ts-drag-nows dc-center"></ul>',success:function(n,o){var t="",a=e.val().substring(1,e.val().indexOf("/i")).split("|");$.each(a,(function(n,e){t+=i.popup.text(a[n],"shibai",0)}));var l="";$.each(layui.common.browse,(function(n,e){l+=i.popup.text(e,"zengjia",n)})),$(".layui-layer-content").addClass("ts-drag-wrap dc-row dc-pa-10"),$(n).find(".ts-drag-nows").html(t).after(i.popup.custom).next().after('<ul class="dc-center">'+l+"</ul>")},yes:function(n,i){var o=[];$(i).find(".ts-drag-nows").find("li").each((function(){o.push($(this).find("span").text())})),e.val("/"+o.join("|")+"/i"),layer.close(n)}})}))},seokey:function(){layui.form.on("submit(seokey)",(function(n){var e=$(this);layer.open({type:1,btn:"确认修改",title:"提示:长按拖动可改变位置",area:["640px","500px"],skin:"ts-drag-seos",content:'<ul class="ts-drag-nows dc-center"></ul>',success:function(n,o){var t="",a=e.val().split("#$#");$.each(a,(function(n,e){t+=i.popup.text(a[n],"shibai",0,1)}));var l="",c=layui.common.seokey;$.each(c,(function(n,o){if("common"==n||$.inArray(e.parents("tbody").find("tr").eq(0).find("td").eq(0).find("input").val(),n.split(","))>-1)for(var t=0;t<o.length;t++)l+=i.popup.text(c[n][t].name,"zengjia",c[n][t].code,0)})),$(".layui-layer-content").addClass("ts-drag-wrap dc-row dc-pa-10"),$(n).find(".ts-drag-nows").html(t).after(i.popup.custom).next().after('<ul class="dc-center">'+l+"</ul>"),i.sorter.init(".ts-drag-sort")},yes:function(n,i){var o=[];$(i).find(".ts-drag-nows").find("li").each((function(){o.push($(this).find("span").text())})),e.css("background-color","powderblue").val(o.join("#$#")),layer.close(n)}})}))},choose:function(){layui.form.on("select(choose)",(function(n){if(!n.elem[$(this).index()].dataset.check)return!1;layer.open({type:2,maxmin:!0,area:["85%","80%"],content:magic.admin+"/admin/"+n.elem[0].dataset.check+"/data",success:function(e,o){var t=layer.getChildFrame("body",o),a=e.find("iframe")[0].contentWindow.layui;t.find(".layui-btn-group").prepend('<a lay-submit lay-filter="choose" class="layui-btn layui-btn-normal dc-choose-btn"><i class="layui-icon">&#xe654;</i>选择返回</a>'),"check"!=n.elem[0].dataset.type&&(t.find('input[lay-filter="allChoose"]').attr("lay-filter",!1).attr("disabled",!0).next().remove(),t.find(".layui-checkbox").removeClass("layui-checkbox").attr("type","radio").next().remove(),a.form.render(),t.find(".layui-form-radio").css("line-height","normal").css("margin","0").css("padding","0").find("i").css("margin","0").css("font-size","18px")),a.form.on("submit(choose)",(function(e){var o=t.find('input[type="radio"]:checked');if(t.find('input[type="checkbox"]').is(":checked")){var l=$(n.elem).prev().val().split(",").filter((function(n){return n&&n.trim()}));t.find('input[type="checkbox"]:checked').each((function(n,e){-1==$.inArray($(this).val(),l)&&(i.define+='<option value="'+$(this).val()+'" selected>'+$(this).parent().next().next().find("a").text()+"</option>",l.push($(this).val()))})),$(n.elem).append(i.define).prev().val(l.join(","))}else{if(!t.find('input[type="radio"]').is(":checked"))return a.layer.msg("请选择数据"),!1;var c=$(n.elem).find("option:first").prop("outerHTML");c+=$(n.elem).find("option").eq(1).prop("outerHTML"),$(n.elem).html(c+'<option value="'+o.val()+'" selected>'+o.parent().next().next().find("a").text()+"</option>")}$(n.elem).val()!=o.val()&&-1==$(n.elem).prev().val().indexOf(l.join(","))||(layui.form.render("select",$(n.elem).parent().attr("lay-filter")),t.find('input[type="checkbox"]').is(":checked")&&i.multiple.render(n.elem),$(n.elem).next().addClass("layui-form-selected"),layui.layer.closeAll(),i.define="")}))}})}))},update:function(){$(".layui-body",parent.document).css("overflow-y","hidden"),$.post(magic.entry+"/index/version",(function(n){var i=["关闭窗口"];1==n.code&&($(".ts-admin-news").html("最新版："+n["new"]+" 立即更新").css("color","red"),i=["立即更新","取消更新"]);var e='<table class="layui-table dc-mt-0 dc-mb-5">';$.each(n.log,(function(i,o){n["new"]==i?e+="<thead></thead>":e+='<thead><tr><th colspan="2" scope="col" style="font-weight:bold">'+i+" 版更新日志</th></tr></thead>",e+="<tbody>";for(var t=0;t<o.length;t++)e+='<tr><td class="ts-note-nums" width="20" align="center">'+(t+1)+'</td><td class="ts-note-item">'+o[t]+"</td></tr>";e+="</tbody>"})),e+="</table>",$(document).on("click",".ts-admin-news",(function(){layer.confirm(e,{area:"auto",maxWidth:"50%",maxHeight:"400",title:"最新版"+n["new"]+'更新日志<font color="red">(升级后静态页面需重新生成)</font>',btn:i,skin:"ts-note-wrap",success:function(){$(".layui-layer-content").css("padding",0)}},(function(i,e){1==n.code?(i=layer.msg("正在升级主题,请稍等",{icon:16}),$.post(magic.entry+"/index/update","new="+n["new"]+"&key="+n.key,(function(n){layer.close(i),layer.msg(n.msg,{time:1e3},(function(){location.reload()}))})).error((function(n){layer.msg("请求失败："+n.status)}),"json")):layer.close(i)}))}))}))}},verify:{init:function(){layui.form.render(),i.verify.treaty(),layui.form.on("submit(submit)",(function(n){return $('input[type="checkbox"]').is(":checked")?(layui.layer.load(2),$.post(location.href,n.field,(function(n){layui.layer.closeAll(),layui.layer.msg(n.msg,(function(){location.href=magic.entry}))})).error((function(n){layui.layer.msg("请求失败："+n.status)}),"json"),!1):(layui.layer.msg("请勾选《用户许可协议》"),!1)})),layui.form.on("submit(treaty)",(function(n){$('input[type="checkbox"]').attr("checked","checked"),layui.layer.closeAll(),layui.form.render()})),layui.form.on("checkbox(encrypt)",(function(n){n.elem.checked&&i.verify.treaty()}))},treaty:function(){$.post(magic.entry+"/index/treaty",(function(n){layui.layer.open({btn:!1,title:!1,closeBtn:0,area:"640px",maxWidth:"60%",content:n,success:function(n,i){var e=Number($(".ts-check-count").text())-1,o=setInterval((function(){0==e&&($(".layui-btn-disabled").attr("lay-filter","treaty").removeClass("layui-btn-disabled"),$(".ts-check-time").remove(),clearInterval(o)),$(".ts-check-count").text(e--)}),1e3)}})}))}},iconfont:{data:function(){return["mo-icon-xiaoshi-line","mo-icon-xiaoshi-fill","mo-icon-yinhangka-line","mo-icon-yinhangka-fill","mo-icon-yanjing-line","mo-icon-yanjing-fill","mo-icon-yingchengka-line","mo-icon-yingchengka-fill","mo-icon-yanchu-line","mo-icon-yanchu-fill","mo-icon-yingyuan-line","mo-icon-yingyuan-fill","mo-icon-zengjia-line","mo-icon-zengjia-fill","mo-icon-youhuiquan-line","mo-icon-youhuiquan-fill","mo-icon-xiangji-line","mo-icon-xiangji-fill","mo-icon-wode-line","mo-icon-wode-fill","mo-icon-tanhao-line","mo-icon-tanhao-fill","mo-icon-pinglun-line","mo-icon-pinglun-fill","mo-icon-shandian-line","mo-icon-shandian-fill","mo-icon-aixin-line","mo-icon-aixin-fill","mo-icon-bangzhu-line","mo-icon-bangzhu-fill","mo-icon-chuangzuo-line","mo-icon-chuangzuo-fill","mo-icon-chenggong-line","mo-icon-chenggong-fill","mo-icon-dianhua-line","mo-icon-dianhua-fill","mo-icon-dianzan-line","mo-icon-dianzan-fill","mo-icon-dingwei-line","mo-icon-dingwei-fill","mo-icon-dianying-line","mo-icon-dianying-fill","mo-icon-dianyingpiao-line","mo-icon-dianyingpiao-fill","mo-icon-faxian-line","mo-icon-faxian-fill","mo-icon-huiyuan-line","mo-icon-huiyuan-fill","mo-icon-huati-line","mo-icon-huati-fill","mo-icon-jianshao-line","mo-icon-jianshao-fill","mo-icon-shequ-line","mo-icon-shequ-fill","mo-icon-shengyin-guan","mo-icon-shengyin-line","mo-icon-shengyin-fill","mo-icon-shibai-line","mo-icon-shibai-fill","mo-icon-shijian-line","mo-icon-shijian-fill","mo-icon-shuju-line","mo-icon-shuju-fill","mo-icon-shouye-line","mo-icon-shouye-fill","mo-icon-shouji-line","mo-icon-shouji-fill","mo-icon-shoucang-line","mo-icon-shoucang-fill","mo-icon-wenda-fill","mo-icon-remen-fill","mo-icon-alipay-line","mo-icon-alipay-fill","mo-icon-edge-line","mo-icon-edge-fill","mo-icon-chrome-line","mo-icon-chrome-fill","mo-icon-firefox-line","mo-icon-firefox-fill","mo-icon-opera-line","mo-icon-opera-fill","mo-icon-qq-line","mo-icon-qq-fill","mo-icon-youtube-line","mo-icon-youtube-fill","mo-icon-weibo-line","mo-icon-weibo-fill","mo-icon-wechat-line","mo-icon-wechat-fill","mo-icon-wechat-pay-line","mo-icon-wechat-pay-fill","mo-icon-group","mo-icon-douyin","mo-icon-aliyu","mo-icon-lihe","mo-icon-shezhi","mo-icon-zixun","mo-icon-bianjigongju","mo-icon-biansu","mo-icon-bianyin","mo-icon-gaoqing","mo-icon-shipin","mo-icon-shipinbiangeng","mo-icon-shipindaofang","mo-icon-shipinfenge","mo-icon-shipinjianji","mo-icon-shipinyasuo","mo-icon-texiao","mo-icon-texiaoshipin","mo-icon-tiaojiecanshu","mo-icon-wuguanggao","mo-icon-play","mo-icon-qq","mo-icon-qiyi","mo-icon-mgtv","mo-icon-youku","mo-icon-pptv","mo-icon-letv","mo-icon-sohu","mo-icon-bilibili","mo-icon-kankan","mo-icon-down","mo-icon-xunlei","mo-icon-baidu","mo-icon-weiyun","mo-icon-paixu","mo-icon-xiangkan-kai","mo-icon-xiangkan-guan","mo-icon-danmu-kai","mo-icon-danmu-guan","mo-icon-xiayiye","mo-icon-shangyiye","mo-icon-xiangxia","mo-icon-xiangshang","mo-icon-xiaolian","mo-icon-putong","mo-icon-kulian","mo-icon-xiayige","mo-icon-shangyige","mo-icon-bianji","mo-icon-yanjing","mo-icon-caidan","mo-icon-anquan","mo-icon-buganxingqu","mo-icon-diantong-guan","mo-icon-ditu","mo-icon-diantong-kai","mo-icon-dingdan","mo-icon-gengduo","mo-icon-fanbei","mo-icon-ertongpiao","mo-icon-gongyi","mo-icon-hongbao","mo-icon-fuzhi","mo-icon-fenxiang","mo-icon-huatifuhao","mo-icon-jiju","mo-icon-kabao","mo-icon-guanzhu","mo-icon-maiyizengyi","mo-icon-mima","mo-icon-nan","mo-icon-nv","mo-icon-paihangbang","mo-icon-lipinka","mo-icon-pengyouquan","mo-icon-mingxinghuodong","mo-icon-qupiao","mo-icon-saoyisao","mo-icon-rili","mo-icon-shaixuan","mo-icon-shangquan","mo-icon-shanchu","mo-icon-xiazai","mo-icon-qinghuiyuan","mo-icon-riqian","mo-icon-shuaxin","mo-icon-sousuo","mo-icon-taolunqu","mo-icon-tianjiayouhuiquan","mo-icon-tishi","mo-icon-tupian","mo-icon-tuipiao","mo-icon-weixuanzhong","mo-icon-weibo","mo-icon-wenjuan","mo-icon-weixin","mo-icon-wodeguanzhu","mo-icon-xiami","mo-icon-xiaoxi","mo-icon-shangchuan","mo-icon-xiaojuchang","mo-icon-wifi","mo-icon-xiaoxizhongxin","mo-icon-yingpingmoban","mo-icon-xiaomi","mo-icon-zhibo","mo-icon-youkuhuiyuan","mo-icon-yulebao","mo-icon-zhiwen","mo-icon-yuyin"]},render:function(n){n=n||'input[iconfont="iconfont"]';for(var i="",e=this.data(),o=0;o<e.length;o++)i+='<dd class="ts-font-item"><i class="mo-icon-font '+e[o]+'"></i></dd>';$(n).hide().each((function(){var n=$(this),e=n.val()?n.val():"mo-icon-shibai-line";n.after('<div class="ts-font-wrap layui-unselect layui-form-select"><div class="ts-font-boxs"><span class="ts-font-icon layui-unselect"><i class="ts-font-btns mo-icon-font '+e+'"></i></span><i class="layui-edge"></i></div><dl class="ts-font-anim layui-anim layui-anim-upbit">'+i+"</dl>")})),$(document).on("click",".ts-font-boxs",(function(n){var i=$(this).parent().offset().top+$(this).parent().outerHeight()+5-$(window).scrollTop(),e=$(this).parent().find("dl").outerHeight();$(this).parent().hasClass("layui-form-selected")?$(".layui-form-select").removeClass("layui-form-selected"):($(".layui-form-select").removeClass("layui-form-selected"),$(this).parent().addClass("layui-form-selected"),i+e>$(window).height()&&i>=e&&$(this).parent().addClass("layui-form-selectup")),n.stopPropagation()})),$(document).on("click",".ts-font-item",(function(n){var i=$(n.currentTarget).find(".mo-icon-font").attr("class").split(/[\s\n]/);$(this).parent().prev().find(".mo-icon-font").attr("class","ts-font-btns "+i.join(" "));var e="mo-icon-shibai-line"==i[1]?"":i[1];$(this).parents(".ts-font-wrap").prev().attr("value",e)}))}},multiple:{checked:[],render:function(n){n=n||'select[multiple="multiple"]',$(n).each((function(n,e){var o=$(this),t=[];o.find("option:selected").each((function(){t.push($(this).val())})),o.next().addClass("ts-multi-wrap").find(".layui-select-title").click((function(){i.multiple.checked[n]&&$(this).find("input").val(i.multiple.checked[n].join(","))})).next().find("dd").each((function(){var e=$(this),a=e.hasClass("layui-this")||$.inArray(e.attr("lay-value"),t)>-1?"checked":"",l=e.text(),c=""===e.attr("lay-value")?"disabled":"";e.addClass("ts-multi-this").html('<input type="checkbox" lay-skin="primary" title="'+l+'" '+a+" "+c+">"),i.multiple.selected(n,o,e)})).click((function(e){var t=$(this);if("dd"==e.target.localName&&""!==t.attr("lay-value")){var a=t.find(".layui-form-checkbox").toggleClass("layui-form-checked").hasClass("layui-form-checked");t.find("input").prop("checked",a)}t.parents(".layui-form-select").addClass("layui-form-selected");var l=$(this).parents(".layui-form-select").offset().top+$(this).parents(".layui-form-select").outerHeight()+5-$(window).scrollTop(),c=$(this).parents(".layui-form-select").find("dl").outerHeight();l+c>$(window).height()&&l>=c&&t.parents(".layui-form-select").addClass("layui-form-selectup"),i.multiple.selected(n,o,t)}))})),layui.form.render("checkbox"),$('[title="添加数据"]').next().removeClass("layui-disabled")},selected:function(n,e,o){var t=[];i.multiple.checked[n]=[],t[n]=[],e.find("option").prop("selected",!1),o.parents("dl").find("[type=checkbox]:checked").each((function(){var o=$(this).parent().attr("lay-value");e.find("option[value="+o+"]").prop("selected",!0),i.multiple.checked[n].push($(this).attr("title")),t[n].push(o)})),o.parents("dl").prev().find("input").val(i.multiple.checked[n].join(",")),o.parents(".layui-form-select").prev().prev().val(t[n].join(",")),o.removeClass("layui-this")}},sorter:{counter:0,dragging:!1,touchDown:!1,originalClientX:"",originalClientY:"",dragElement:"",elements:"",cloned:"",init:function(n){$.fn.arrangeable=function(n){i.sorter.elements=this;var e=i.sorter.getEventNamespace(),o="ontouchstart"in document.documentElement?{START:"touchstart",MOVE:"touchmove",END:"touchend"}:{START:"mousedown",MOVE:"mousemove",END:"mouseup"};this.each((function(){var n=this;$(this).on(o.START+e,(function(e){e.stopPropagation(),i.sorter.touchDown=!0,i.sorter.originalClientX=e.clientX||e.originalEvent.touches[0].clientX,i.sorter.originalClientY=e.clientY||e.originalEvent.touches[0].clientY,i.sorter.dragElement=n}))})),$(document).on(o.MOVE+e,i.sorter.dragMoveHandler).on(o.END+e,i.sorter.dragEndHandler),this.eq(0).data("drag-arrange-destroy",(function(){i.sorter.elements.each((function(){$(this).off(o.START+e)})),$(document).off(o.MOVE+e).off(o.END+e),i.sorter.elements.eq(0).data("drag-arrange-destroy",null),i.sorter.elements=null,i.sorter.dragMoveHandler=null,i.sorter.dragEndHandler=null}))},$(n).arrangeable()},dragMoveHandler:function(n){if(i.sorter.touchDown){var e=$(i.sorter.dragElement),o=(n.clientX||n.originalEvent.touches[0].clientX)-i.sorter.originalClientX,t=(n.clientY||n.originalEvent.touches[0].clientY)-i.sorter.originalClientY;i.sorter.dragging?(n.stopPropagation(),i.sorter.cloned.css({left:leftOffset+o,top:topOffset+t}),i.sorter.shiftHoveredElement(i.sorter.cloned,e,i.sorter.elements)):(Math.abs(o)>5||Math.abs(t)>5)&&(i.sorter.cloned=i.sorter.clone(e),leftOffset=i.sorter.dragElement.offsetLeft-parseInt(e.css("margin-left"))-parseInt(e.css("padding-left")),topOffset=i.sorter.dragElement.offsetTop-parseInt(e.css("margin-top"))-parseInt(e.css("padding-top")),i.sorter.cloned.css({left:leftOffset,top:topOffset}),e.parent().append(i.sorter.cloned),e.css("visibility","hidden"),i.sorter.dragging=!0)}},dragEndHandler:function(n){i.sorter.dragging&&(n.stopPropagation(),i.sorter.dragging=!1,i.sorter.cloned.remove(),i.sorter.dragElement.style.visibility="visible",$(i.sorter.dragElement).parent().trigger("drag.end.arrangeable",[$(i.sorter.dragElement)])),i.sorter.touchDown=!1},shiftElementPosition:function(n,i,e){var o=n.splice(i,1)[0];return n.splice(e,0,o)},getEventNamespace:function(){return i.sorter.counter+=1,".drag-arrange-"+i.sorter.counter},shiftHoveredElement:function(n,e,o){var t=i.sorter.getHoveredElement(n,e,o);if(t!==e[0]){var a=o.index(t),l=o.index(e);a<l?$(t).before(e):$(t).after(e),i.sorter.shiftElementPosition(o,l,a)}},getHoveredElement:function(n,i,e){for(var o,t,a,l,c=n.offset(),r=n.width(),s=n.height(),u=c.left,m=c.left+r,d=c.top,f=c.top+s,p=0;p<e.length;p++)if((o=e.eq(p))[0]!==i[0]&&(t=(l=o.offset()).left+.5*o.width(),a=l.top+.5*o.height(),t<m&&t>u&&a<f&&a>d))return o[0]},clone:function(n){var i=n.clone();return i.css({position:"absolute",width:n.width(),height:n.height(),"z-index":1e5}),i}}};n("admin",i)}));